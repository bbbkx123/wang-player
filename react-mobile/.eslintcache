[{"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\index.tsx":"1","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\App.tsx":"2","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\layouts\\index.tsx":"3","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\store\\index.ts":"4","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\views\\recommend\\index.tsx":"5","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\views\\PlayPage\\index.tsx":"6","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\utils\\hook.ts":"7","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\index.tsx":"8","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\components\\Player\\index.tsx":"9","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\components\\ProgressBar\\index.tsx":"10","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\http.ts":"11","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\utils\\tools.ts":"12","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\config.ts":"13"},{"size":171,"mtime":1615165785170,"results":"14","hashOfConfig":"15"},{"size":286,"mtime":1615165785167,"results":"16","hashOfConfig":"15"},{"size":1286,"mtime":1617764803505,"results":"17","hashOfConfig":"15"},{"size":1248,"mtime":1617863121381,"results":"18","hashOfConfig":"15"},{"size":455,"mtime":1615165785179,"results":"19","hashOfConfig":"15"},{"size":5080,"mtime":1617874149111,"results":"20","hashOfConfig":"15"},{"size":990,"mtime":1615165785175,"results":"21","hashOfConfig":"15"},{"size":802,"mtime":1615165785174,"results":"22","hashOfConfig":"15"},{"size":3012,"mtime":1617870120341,"results":"23","hashOfConfig":"15"},{"size":5160,"mtime":1617783328000,"results":"24","hashOfConfig":"15"},{"size":864,"mtime":1615165785173,"results":"25","hashOfConfig":"15"},{"size":1203,"mtime":1617690178587,"results":"26","hashOfConfig":"15"},{"size":127,"mtime":1615165785173,"results":"27","hashOfConfig":"15"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},"4mpgx7",{"filePath":"31","messages":"32","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"33","messages":"34","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"35","usedDeprecatedRules":"30"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"38","messages":"39","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"40","usedDeprecatedRules":"30"},{"filePath":"41","messages":"42","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"43","messages":"44","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"45","usedDeprecatedRules":"30"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"50","messages":"51","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"52","usedDeprecatedRules":"30"},{"filePath":"53","messages":"54","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"30"},{"filePath":"55","messages":"56","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"57","usedDeprecatedRules":"30"},{"filePath":"58","messages":"59","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"60","usedDeprecatedRules":"30"},"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\index.tsx",[],["61","62"],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\App.tsx",[],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\layouts\\index.tsx",["63"],"import { useState, useReducer } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { Route } from \"react-router-dom\";\r\nimport { NavBar, Icon } from \"antd-mobile\";\r\n\r\nimport { reducer, AppContext, defaultState } from \"@/store\";\r\n\r\nimport PlayPage from \"@/views/PlayPage\";\r\nimport Recommend from \"@/views/recommend\";\r\nimport \"./index.less\";\r\n\r\nconst Layouts = (props: any) => {\r\n  const { history } = props;\r\n  const [pageTitle, setPageTitle] = useState<string>(\"default title\");\r\n\r\n  const handleClick = () => {\r\n    history.push(\"/play\");\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(reducer, defaultState);\r\n\r\n  return (\r\n    <AppContext.Provider value={{ ...state, dispatch }}>\r\n      <div className=\"layouts\">\r\n        <NavBar\r\n          mode=\"light\"\r\n          icon={<Icon type=\"left\" />}\r\n          onLeftClick={handleClick}\r\n          rightContent={[\r\n            <Icon key=\"0\" type=\"search\" style={{ marginRight: \"16px\" }} />,\r\n            <Icon key=\"1\" type=\"ellipsis\" />,\r\n          ]}\r\n        >\r\n          {pageTitle}\r\n        </NavBar>\r\n        <Route path=\"/play\" component={PlayPage}></Route>\r\n        <Route path=\"/recommend\" component={Recommend}></Route>\r\n      </div>\r\n    </AppContext.Provider>\r\n  );\r\n};\r\n\r\nexport default withRouter(Layouts);\r\n","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\store\\index.ts",[],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\views\\recommend\\index.tsx",["64","65","66","67","68"],"import {useState} from 'react'\r\n// import {Route} from 'react-router-dom'\r\nimport {TabBar} from 'antd-mobile'\r\n\r\nconst Route1 = () => {\r\n  return (\r\n    <div>Route1</div>\r\n  )\r\n}\r\n\r\nconst Route2 = () => {\r\n  return (\r\n    <div>Route2</div>\r\n  )\r\n}\r\n\r\nconst TAB = ['FIRST', 'SECOND']\r\n\r\nconst Recommend = () => {\r\n  const [selectedTab, setSelectedTab] = useState<String>(TAB[0])\r\n  return (\r\n    <div>\r\n     \r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Recommend","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\views\\PlayPage\\index.tsx",["69","70","71","72","73"],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\utils\\hook.ts",["74"],"import {useEffect, useRef} from 'react'\r\n\r\ntype CallBack<T> = (prev: T | undefined) => void;\r\ntype Config = { immediate: boolean };\r\n\r\n/**\r\n * useWatch\r\n * @param dep 监听对象\r\n * @param callback\r\n * @param config 监听设置\r\n */\r\n\r\nfunction useWatch<T>(\r\n  dep: T,\r\n  callback: CallBack<T>,\r\n  config: Config = { immediate: false },\r\n) {\r\n  // 监听禁止标志\r\n  const stop = useRef<boolean>(false);\r\n  // 初始化标志\r\n  const inited = useRef<boolean>(false);\r\n  const prev = useRef<T>();\r\n  const { immediate } = config;\r\n\r\n  useEffect(() => {\r\n    if (!stop.current) {\r\n      const execute = () => callback(prev.current);\r\n      // 防止immediate为false时, 首次加载就执行\r\n      if (!inited.current) {\r\n        inited.current = true;\r\n        if (immediate) {\r\n          execute();\r\n        }\r\n      } else {\r\n        execute();\r\n      }\r\n      prev.current = dep;\r\n    }\r\n  }, [dep]);\r\n\r\n  return () => {\r\n    stop.current = true;\r\n  };\r\n}\r\n\r\nexport { useWatch };","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\index.tsx",[],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\components\\Player\\index.tsx",["75","76","77","78","79","80","81","82"],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\components\\ProgressBar\\index.tsx",["83"],"import { useContext, useEffect, useRef, useState } from \"react\";\r\n\r\nimport { AppContext } from \"@/store\";\r\nimport { throttle } from \"@/utils/tools\";\r\n// import {useWatch} from '@/utils/hook'\r\nimport \"./index.less\";\r\n\r\n// 进度条按钮宽度\r\nconst progressBarWidth = 16;\r\n// mousedown到mopuseup间隔时间, 用于区分click和mouseup, 超过150ms为mouse事件, 否则为click事件\r\nconst refelctTime = 0.1;\r\n\r\n// ! 问题: 全面屏手势滑动会进行翻页, 导致touchmove不能正确调用\r\n// ? 测试发现小米手机浏览器存在原生滑动事件, 导致问题, 在微信中可正常使用\r\n\r\nconst ProgressBar = (props: any) => {\r\n  const { percent } = props;\r\n  const progressBar = useRef<any>(null),\r\n    progress = useRef<any>(null),\r\n    progressBtn = useRef<any>(null);\r\n  const { startTime, dispatch, EventEmitter } = useContext<any>(AppContext);\r\n  const [touch, setTouch] = useState({\r\n    initiated: false,\r\n    startX: 0,\r\n  });\r\n  const [progressClientWidth, setProgressClientWidth] = useState<number>(0);\r\n  const [barWidth, setBarWidth] = useState<number | null>(null);\r\n\r\n  const progressClick = (e: any) => {\r\n    // 解决mouseup和click重发触发的问题\r\n    let diff = (new Date().getTime() - startTime) / 1000;\r\n    if (diff > refelctTime) return;\r\n    // .getBoundingClientRect()\r\n    const rect = progressBar.current.getBoundingClientRect();\r\n    const offsetWidth = e.touches[0].clientX - rect.left;\r\n    handleOffset(offsetWidth);\r\n    EventEmitter.emit(\"progress-change\", getPrecent());\r\n  };\r\n\r\n  // const handleOffset = (offsetWidth: any) => {\r\n  //   return new Promise((resolve, reject) => {\r\n  //     try {\r\n  //       progress.current.style.width = `${offsetWidth}px`;\r\n  //       progressBtn.current.style.transform = `translate3d(${offsetWidth}px, 0, 0)`;\r\n  //       resolve(true)\r\n  //     } catch (err) {\r\n  //       reject(err);\r\n  //     }\r\n  //     // 保证获取更新后的dom\r\n  //     // this.$nextTick(() => resolve())\r\n  //   });\r\n  // };\r\n\r\n  const handleOffset = (offsetWidth: any) => {\r\n    progress.current.style.width = `${offsetWidth}px`;\r\n    progressBtn.current.style.transform = `translate3d(${offsetWidth}px, 0, 0)`;\r\n  };\r\n\r\n  const progressTouchMove = (e: any) => {\r\n    // ?   Math.max(0, this.progressClientWidth + deltaX) -->  0  移动超出左边界\r\n    // ?   Math.max(0, this.progressClientWidth + deltaX) -->  delta  正常移动\r\n    // ?\r\n    // ?   this.barWidth 实际进度条宽度\r\n    // ?   b = Math.max(0, this.progressClientWidth + deltaX)\r\n    // ?   Math.min(a, b)  -->  a 超出右边界\r\n    // ?   Math.min(a, b)  -->  b 正常移动\r\n\r\n    if (!touch.initiated) return;\r\n    const deltaX = e.touches[0].clientX - touch.startX;\r\n    const offsetWidth = Math.min(\r\n      barWidth === null ? 0 : barWidth,\r\n      Math.max(0, progressClientWidth + deltaX)\r\n    );\r\n    handleOffset(offsetWidth);\r\n    console.log(11111111111111111111111111);\r\n    \r\n    EventEmitter.emit(\"progress-changing\", getPrecent());\r\n  };\r\n\r\n  const progressTouchStart = (e: any) => {\r\n    setTouch({\r\n      initiated: true,\r\n      startX: e.touches[0].clientX,\r\n    });\r\n    setProgressClientWidth(progress.current.clientWidth);\r\n    dispatch({ type: \"startTime\", value: new Date().getTime() });\r\n  };\r\n\r\n  const _progressTouchMove = (e: any) => {\r\n    throttle(progressTouchMove, 200, 0)([e]);\r\n    // progressTouchMove(e)\r\n  };\r\n\r\n  const progressTouchEnd = () => {\r\n    // 出现问题: 从$refs获取样式数据会取到更新之前的数据\r\n    // 在move事件上启用节流后, 可以避免使用定时器\r\n    // 先抛出事件, 再将initiated修改为false\r\n    EventEmitter.emit(\"progress-change\", getPrecent());\r\n    setTouch({\r\n      ...touch,\r\n      initiated: false,\r\n    });\r\n  };\r\n\r\n  const getPrecent = () => {\r\n    return progress.current.clientWidth / (barWidth === null ? 0 : barWidth);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setBarWidth(progressBar.current.clientWidth - progressBarWidth);\r\n  }, []);\r\n\r\n  // useWatch(percent, (old) => {\r\n  //   // timeupdate事件触发\r\n  //   if (percent > 0 && !touch.initiated && barWidth) {\r\n  //     const offsetWidth = percent * barWidth\r\n  //     handleOffset(offsetWidth)\r\n  //   }\r\n  // })\r\n\r\n  useEffect(() => {\r\n    // timeupdate事件触发\r\n    if (percent > 0 && !touch.initiated && barWidth) {\r\n      const offsetWidth = percent * barWidth;\r\n      handleOffset(offsetWidth);\r\n    }\r\n  }, [percent]);\r\n\r\n  return (\r\n    <div\r\n      className=\"progress-bar__container\"\r\n      ref={progressBar}\r\n      onClick={progressClick}\r\n    >\r\n      <div\r\n        className=\"progress-bar\"\r\n        onTouchStart={progressTouchStart}\r\n        onTouchMove={_progressTouchMove}\r\n        onTouchEnd={progressTouchEnd}\r\n      >\r\n        <div className=\"progress-bar__background\"></div>\r\n        {/* 进度条 */}\r\n        <div className=\"progress-bar--progress\" ref={progress}></div>\r\n        {/* 当前进度按钮 */}\r\n        <div className=\"progress-bar--btn__wrapper\" ref={progressBtn}>\r\n          <div className=\"progress-bar--btn\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgressBar;\r\n","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\http.ts",[],"D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\utils\\tools.ts",["84","85"],"import {useEffect, useRef} from 'react'\r\n\r\n/**\r\n * 节流\r\n * @param {Function} fn 目标函数 \r\n * @param {Number} wait 间隔时间\r\n * @param {Number} type 模式  0 ---> timestamp , 1 ---> timeout\r\n */\r\nexport function throttle (fn: any, wait: any, type: any) {\r\n  const context = this\r\n  return function (_arguments: any[]) {\r\n    if (type === 0) {\r\n      let newTimestamp = new Date().getTime()\r\n      if (!fn._timestamp) fn._timestamp = 0\r\n      if (newTimestamp - fn._timestamp > wait) {\r\n        fn.call(context, ..._arguments)\r\n        fn._timestamp = newTimestamp\r\n      }\r\n    } else {\r\n      if (!fn._timeout) {\r\n        fn._timeout = setTimeout(() => {\r\n          fn.call(context, ..._arguments)\r\n          fn._timeout = null\r\n          clearTimeout(fn._timeout)\r\n        }, wait)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// 时间格式化\r\nexport const formatForPlayTime = (time: any) => {\r\n  if (time === null || typeof time === 'undefined') return\r\n  if (time === 0) return '00:00'\r\n  time = parseFloat(time)\r\n  if (typeof time !== 'number') return \r\n  let _format = (time: any) => time >= 10 ? time : `0${time}`\r\n  return _format(Math.floor(time / 60)) + ':' + _format((time % 60).toFixed(0))\r\n}\r\n","D:\\wangyufei\\mine\\wang-player\\react-mobile\\src\\service\\config.ts",["86"],"export default {\r\n  baseUrl: process.env.NODE_ENV === \"development\" ? \"http://localhost:3000\" : \"http://106.13.207.132:3000\"\r\n}",{"ruleId":"87","replacedBy":"88"},{"ruleId":"89","replacedBy":"90"},{"ruleId":"91","severity":1,"message":"92","line":14,"column":21,"nodeType":"93","messageId":"94","endLine":14,"endColumn":33},{"ruleId":"91","severity":1,"message":"95","line":3,"column":9,"nodeType":"93","messageId":"94","endLine":3,"endColumn":15},{"ruleId":"91","severity":1,"message":"96","line":5,"column":7,"nodeType":"93","messageId":"94","endLine":5,"endColumn":13},{"ruleId":"91","severity":1,"message":"97","line":11,"column":7,"nodeType":"93","messageId":"94","endLine":11,"endColumn":13},{"ruleId":"91","severity":1,"message":"98","line":20,"column":10,"nodeType":"93","messageId":"94","endLine":20,"endColumn":21},{"ruleId":"91","severity":1,"message":"99","line":20,"column":23,"nodeType":"93","messageId":"94","endLine":20,"endColumn":37},{"ruleId":"91","severity":1,"message":"100","line":21,"column":10,"nodeType":"93","messageId":"94","endLine":21,"endColumn":28},{"ruleId":"91","severity":1,"message":"101","line":29,"column":44,"nodeType":"93","messageId":"94","endLine":29,"endColumn":50},{"ruleId":"102","severity":1,"message":"103","line":110,"column":6,"nodeType":"104","endLine":110,"endColumn":29,"suggestions":"105"},{"ruleId":"102","severity":1,"message":"106","line":117,"column":6,"nodeType":"104","endLine":117,"endColumn":8,"suggestions":"107"},{"ruleId":"102","severity":1,"message":"108","line":129,"column":6,"nodeType":"104","endLine":129,"endColumn":8,"suggestions":"109"},{"ruleId":"102","severity":1,"message":"110","line":39,"column":6,"nodeType":"104","endLine":39,"endColumn":11,"suggestions":"111"},{"ruleId":"91","severity":1,"message":"112","line":1,"column":30,"nodeType":"93","messageId":"94","endLine":1,"endColumn":36},{"ruleId":"91","severity":1,"message":"113","line":5,"column":10,"nodeType":"93","messageId":"94","endLine":5,"endColumn":18},{"ruleId":"91","severity":1,"message":"114","line":9,"column":45,"nodeType":"93","messageId":"94","endLine":9,"endColumn":53},{"ruleId":"91","severity":1,"message":"115","line":15,"column":10,"nodeType":"93","messageId":"94","endLine":15,"endColumn":16},{"ruleId":"91","severity":1,"message":"116","line":16,"column":16,"nodeType":"93","messageId":"94","endLine":16,"endColumn":23},{"ruleId":"91","severity":1,"message":"117","line":17,"column":10,"nodeType":"93","messageId":"94","endLine":17,"endColumn":18},{"ruleId":"91","severity":1,"message":"118","line":18,"column":16,"nodeType":"93","messageId":"94","endLine":18,"endColumn":23},{"ruleId":"102","severity":1,"message":"119","line":73,"column":6,"nodeType":"104","endLine":73,"endColumn":8,"suggestions":"120"},{"ruleId":"102","severity":1,"message":"121","line":127,"column":6,"nodeType":"104","endLine":127,"endColumn":15,"suggestions":"122"},{"ruleId":"91","severity":1,"message":"123","line":1,"column":9,"nodeType":"93","messageId":"94","endLine":1,"endColumn":18},{"ruleId":"91","severity":1,"message":"112","line":1,"column":20,"nodeType":"93","messageId":"94","endLine":1,"endColumn":26},{"ruleId":"124","severity":1,"message":"125","line":1,"column":1,"nodeType":"126","endLine":3,"endColumn":2},"no-native-reassign",["127"],"no-negated-in-lhs",["128"],"@typescript-eslint/no-unused-vars","'setPageTitle' is assigned a value but never used.","Identifier","unusedVar","'TabBar' is defined but never used.","'Route1' is assigned a value but never used.","'Route2' is assigned a value but never used.","'selectedTab' is assigned a value but never used.","'setSelectedTab' is assigned a value but never used.","'isProgressChanging' is assigned a value but never used.","'tracks' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'EventEmitter' and 'fun123'. Either include them or remove the dependency array.","ArrayExpression",["129"],"React Hook useEffect has a missing dependency: 'EventEmitter'. Either include it or remove the dependency array.",["130"],"React Hook useEffect has a missing dependency: 'getPlayListDetail'. Either include it or remove the dependency array.",["131"],"React Hook useEffect has missing dependencies: 'callback' and 'immediate'. Either include them or remove the dependency array. If 'callback' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["132"],"'useRef' is defined but never used.","'throttle' is defined but never used.","'duration' is assigned a value but never used.","'volume' is assigned a value but never used.","'setLoop' is assigned a value but never used.","'autoPlay' is assigned a value but never used.","'setPlay' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'audioRef'. Either include it or remove the dependency array. If 'setVolume' needs the current value of 'audioRef', you can also switch to useReducer instead of useState and read 'audioRef' in the reducer.",["133"],"React Hook useEffect has missing dependencies: 'barWidth' and 'touch.initiated'. Either include them or remove the dependency array.",["134"],"'useEffect' is defined but never used.","import/no-anonymous-default-export","Assign object to a variable before exporting as module default","ExportDefaultDeclaration","no-global-assign","no-unsafe-negation",{"desc":"135","fix":"136"},{"desc":"137","fix":"138"},{"desc":"139","fix":"140"},{"desc":"141","fix":"142"},{"desc":"143","fix":"144"},{"desc":"145","fix":"146"},"Update the dependencies array to be: [EventEmitter, currentTime, duration, fun123]",{"range":"147","text":"148"},"Update the dependencies array to be: [EventEmitter]",{"range":"149","text":"150"},"Update the dependencies array to be: [getPlayListDetail]",{"range":"151","text":"152"},"Update the dependencies array to be: [callback, dep, immediate]",{"range":"153","text":"154"},"Update the dependencies array to be: [audioRef]",{"range":"155","text":"156"},"Update the dependencies array to be: [barWidth, percent, touch.initiated]",{"range":"157","text":"158"},[3638,3661],"[EventEmitter, currentTime, duration, fun123]",[3854,3856],"[EventEmitter]",[4236,4238],"[getPlayListDetail]",[844,849],"[callback, dep, immediate]",[2431,2433],"[audioRef]",[4072,4081],"[barWidth, percent, touch.initiated]"]