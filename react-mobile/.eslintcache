[{"E:\\web-project\\wang-player1\\react-mobile\\src\\index.tsx":"1","E:\\web-project\\wang-player1\\react-mobile\\src\\App.tsx":"2","E:\\web-project\\wang-player1\\react-mobile\\src\\layouts\\index.tsx":"3","E:\\web-project\\wang-player1\\react-mobile\\src\\store\\index.ts":"4","E:\\web-project\\wang-player1\\react-mobile\\src\\views\\play\\index.tsx":"5","E:\\web-project\\wang-player1\\react-mobile\\src\\views\\recommend\\index.tsx":"6","E:\\web-project\\wang-player1\\react-mobile\\src\\components\\ProgressBar\\index.tsx":"7","E:\\web-project\\wang-player1\\react-mobile\\src\\utils\\tools.ts":"8"},{"size":171,"mtime":1613376482086,"results":"9","hashOfConfig":"10"},{"size":286,"mtime":1613376482085,"results":"11","hashOfConfig":"10"},{"size":1274,"mtime":1613376482087,"results":"12","hashOfConfig":"10"},{"size":524,"mtime":1613376482087,"results":"13","hashOfConfig":"10"},{"size":4301,"mtime":1613825439914,"results":"14","hashOfConfig":"10"},{"size":455,"mtime":1613376482089,"results":"15","hashOfConfig":"10"},{"size":5073,"mtime":1613463271813,"results":"16","hashOfConfig":"10"},{"size":1575,"mtime":1613376482088,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},"ccjppx",{"filePath":"21","messages":"22","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"23","messages":"24","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"25","usedDeprecatedRules":"20"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"20"},{"filePath":"28","messages":"29","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"30","messages":"31","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32","usedDeprecatedRules":"20"},{"filePath":"33","messages":"34","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"35","usedDeprecatedRules":"20"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"38","usedDeprecatedRules":"20"},"E:\\web-project\\wang-player1\\react-mobile\\src\\index.tsx",[],["39","40"],"E:\\web-project\\wang-player1\\react-mobile\\src\\App.tsx",[],"E:\\web-project\\wang-player1\\react-mobile\\src\\layouts\\index.tsx",["41"],"import { useState, useReducer } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { Route } from \"react-router-dom\";\r\nimport { NavBar, Icon } from \"antd-mobile\";\r\n\r\nimport { reducer, AppContext, defaultState } from \"@/store\";\r\n\r\nimport Play from \"@/views/play\";\r\nimport Recommend from \"@/views/recommend\";\r\nimport \"./index.less\";\r\n\r\nconst Layouts = (props: any) => {\r\n  const { history } = props;\r\n  const [pageTitle, setPageTitle] = useState<string>(\"default title\");\r\n\r\n  const handleClick = () => {\r\n    history.push(\"/play\");\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(reducer, defaultState);\r\n\r\n  return (\r\n    <AppContext.Provider value={{ ...state, dispatch }}>\r\n      <div className=\"layouts\">\r\n        <NavBar\r\n          mode=\"light\"\r\n          icon={<Icon type=\"left\" />}\r\n          onLeftClick={handleClick}\r\n          rightContent={[\r\n            <Icon key=\"0\" type=\"search\" style={{ marginRight: \"16px\" }} />,\r\n            <Icon key=\"1\" type=\"ellipsis\" />,\r\n          ]}\r\n        >\r\n          {pageTitle}\r\n        </NavBar>\r\n        <Route path=\"/play\" component={Play}></Route>\r\n        <Route path=\"/recommend\" component={Recommend}></Route>\r\n      </div>\r\n    </AppContext.Provider>\r\n  );\r\n};\r\n\r\nexport default withRouter(Layouts);\r\n","E:\\web-project\\wang-player1\\react-mobile\\src\\store\\index.ts",[],"E:\\web-project\\wang-player1\\react-mobile\\src\\views\\play\\index.tsx",["42","43","44","45"],"E:\\web-project\\wang-player1\\react-mobile\\src\\views\\recommend\\index.tsx",["46","47","48","49","50"],"import {useState} from 'react'\r\n// import {Route} from 'react-router-dom'\r\nimport {TabBar} from 'antd-mobile'\r\n\r\nconst Route1 = () => {\r\n  return (\r\n    <div>Route1</div>\r\n  )\r\n}\r\n\r\nconst Route2 = () => {\r\n  return (\r\n    <div>Route2</div>\r\n  )\r\n}\r\n\r\nconst TAB = ['FIRST', 'SECOND']\r\n\r\nconst Recommend = () => {\r\n  const [selectedTab, setSelectedTab] = useState<String>(TAB[0])\r\n  return (\r\n    <div>\r\n     \r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Recommend","E:\\web-project\\wang-player1\\react-mobile\\src\\components\\ProgressBar\\index.tsx",["51","52"],"import { useContext, useEffect, useRef, useState } from \"react\";\r\n\r\nimport { AppContext } from \"@/store\";\r\nimport { throttle, useWatch } from \"@/utils/tools\";\r\nimport './index.less'\r\n\r\n// 进度条按钮宽度\r\nconst progressBarWidth = 16;\r\n// mousedown到mopuseup间隔时间, 用于区分click和mouseup, 超过150ms为mouse事件, 否则为click事件\r\nconst refelctTime = 0.1;\r\n\r\n// ! 问题: 全面屏手势滑动会进行翻页, 导致touchmove不能正确调用\r\n// ? 测试发现小米手机浏览器存在原生滑动事件, 导致问题, 在微信中可正常使用\r\n\r\nconst ProgressBar = (props: any) => {\r\n  const { percent } = props;\r\n  const progressBar = useRef<any>(null),\r\n    progress = useRef<any>(null),\r\n    progressBtn = useRef<any>(null);\r\n  const { startTime, dispatch, EventEmitter } = useContext<any>(AppContext);\r\n  const [touch, setTouch] = useState({\r\n    initiated: false,\r\n    startX: 0,\r\n  });\r\n  const [progressClientWidth, setProgressClientWidth] = useState<number>(0);\r\n  const [barWidth, setBarWidth] = useState<number | null>(null);\r\n\r\n  const progressClick = (e: any) => {\r\n    // 解决mouseup和click重发触发的问题\r\n    let diff = (new Date().getTime() - startTime) / 1000;\r\n    if (diff > refelctTime) return;\r\n    // .getBoundingClientRect()\r\n    const rect = progressBar.current.getBoundingClientRect();\r\n    const offsetWidth = e.touches[0].clientX - rect.left;\r\n    handleOffset(offsetWidth)\r\n    EventEmitter.emit(\"progress-change\", getPrecent());\r\n  };\r\n\r\n  // const handleOffset = (offsetWidth: any) => {\r\n  //   return new Promise((resolve, reject) => {\r\n  //     try {\r\n  //       progress.current.style.width = `${offsetWidth}px`;\r\n  //       progressBtn.current.style.transform = `translate3d(${offsetWidth}px, 0, 0)`;\r\n  //       resolve(true)\r\n  //     } catch (err) {\r\n  //       reject(err);\r\n  //     }\r\n  //     // 保证获取更新后的dom\r\n  //     // this.$nextTick(() => resolve())\r\n  //   });\r\n  // };\r\n\r\n  const handleOffset = (offsetWidth: any) => {\r\n    progress.current.style.width = `${offsetWidth}px`;\r\n    progressBtn.current.style.transform = `translate3d(${offsetWidth}px, 0, 0)`;\r\n  };\r\n\r\n  const progressTouchMove = (e: any) => {\r\n    // ?   Math.max(0, this.progressClientWidth + deltaX) -->  0  移动超出左边界\r\n    // ?   Math.max(0, this.progressClientWidth + deltaX) -->  delta  正常移动\r\n    // ?\r\n    // ?   this.barWidth 实际进度条宽度\r\n    // ?   b = Math.max(0, this.progressClientWidth + deltaX)\r\n    // ?   Math.min(a, b)  -->  a 超出右边界\r\n    // ?   Math.min(a, b)  -->  b 正常移动\r\n\r\n    if (!touch.initiated) return;\r\n    const deltaX = e.touches[0].clientX - touch.startX;\r\n    const offsetWidth = Math.min(\r\n      barWidth === null ? 0 : barWidth,\r\n      Math.max(0, progressClientWidth + deltaX)\r\n    );\r\n    handleOffset(offsetWidth)\r\n    EventEmitter.emit(\"progress-changing\", getPrecent());\r\n  };\r\n\r\n  const progressTouchStart = (e: any) => {\r\n    setTouch({\r\n      initiated: true,\r\n      startX: e.touches[0].clientX,\r\n    });\r\n    setProgressClientWidth(progress.current.clientWidth);\r\n    dispatch({ type: \"startTime\", value: new Date().getTime() });\r\n  };\r\n\r\n  const _progressTouchMove = (e: any) => {\r\n    throttle(progressTouchMove, 200, 0)([e]);\r\n    // progressTouchMove(e)\r\n  };\r\n\r\n  const progressTouchEnd = () => {\r\n    // 出现问题: 从$refs获取样式数据会取到更新之前的数据\r\n    // 在move事件上启用节流后, 可以避免使用定时器\r\n    // 先抛出事件, 再将initiated修改为false\r\n    EventEmitter.emit(\"progress-change\", getPrecent());\r\n    setTouch({\r\n      ...touch,\r\n      initiated: false,\r\n    });\r\n  };\r\n\r\n  const getPrecent = () => {\r\n    return progress.current.clientWidth / (barWidth === null ? 0 : barWidth);\r\n  };\r\n\r\n  useEffect(() => {\r\n    setBarWidth(progressBar.current.clientWidth - progressBarWidth);\r\n  }, []);\r\n\r\n  // useWatch(percent, (old) => {\r\n  //   // timeupdate事件触发\r\n  //   if (percent > 0 && !touch.initiated && barWidth) {\r\n  //     const offsetWidth = percent * barWidth\r\n  //     handleOffset(offsetWidth)\r\n  //   }\r\n  // })\r\n\r\n  useEffect(() => {\r\n    // timeupdate事件触发\r\n    if (percent > 0 && !touch.initiated && barWidth) {\r\n      const offsetWidth = percent * barWidth;\r\n      handleOffset(offsetWidth);\r\n    }\r\n  }, [percent]);\r\n\r\n  return (\r\n    <div\r\n      className=\"progress-bar__container\"\r\n      ref={progressBar}\r\n      onClick={progressClick}\r\n    >\r\n      <div\r\n        className=\"progress-bar\"\r\n        onTouchStart={progressTouchStart}\r\n        onTouchMove={_progressTouchMove}\r\n        onTouchEnd={progressTouchEnd}\r\n      >\r\n        <div className=\"progress-bar__background\"></div>\r\n        {/* 进度条 */}\r\n        <div className=\"progress-bar--progress\" ref={progress}></div>\r\n        {/* 当前进度按钮 */}\r\n        <div className=\"progress-bar--btn__wrapper\" ref={progressBtn}>\r\n          <div className=\"progress-bar--btn\"></div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProgressBar;\r\n","E:\\web-project\\wang-player1\\react-mobile\\src\\utils\\tools.ts",["53"],"import {useEffect, useRef} from 'react'\r\n\r\n/**\r\n * 节流\r\n * @param {Function} fn 目标函数 \r\n * @param {Number} wait 间隔时间\r\n * @param {Number} type 模式  0 ---> timestamp , 1 ---> timeout\r\n */\r\nexport function throttle (fn: any, wait: any, type: any) {\r\n  const context = this\r\n  return function (_arguments: any[]) {\r\n    if (type === 0) {\r\n      let newTimestamp = new Date().getTime()\r\n      if (!fn._timestamp) fn._timestamp = 0\r\n      if (newTimestamp - fn._timestamp > wait) {\r\n        fn.call(context, ..._arguments)\r\n        fn._timestamp = newTimestamp\r\n      }\r\n    } else {\r\n      if (!fn._timeout) {\r\n        fn._timeout = setTimeout(() => {\r\n          fn.call(context, ..._arguments)\r\n          fn._timeout = null\r\n          clearTimeout(fn._timeout)\r\n        }, wait)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// https://juejin.cn/post/6844904078653276167#comment\r\ntype Callback<T> = (prev: T | undefined) => void;\r\ntype Config = {\r\n  immediate: boolean;\r\n};\r\n\r\nexport function useWatch<T>(dep: T, callback: Callback<T>, config: Config = { immediate: false }) {\r\n  const { immediate } = config;\r\n\r\n  const prev = useRef<T>();\r\n  const inited = useRef(false);\r\n  const stop = useRef(false);\r\n\r\n  useEffect(() => {\r\n    const execute = () => callback(prev.current);\r\n\r\n    if (!stop.current) {\r\n      if (!inited.current) {\r\n        inited.current = true;\r\n        if (immediate) {\r\n          execute();\r\n        }\r\n      } else {\r\n        execute();\r\n      }\r\n      prev.current = dep;\r\n    }\r\n  }, [dep]);\r\n\r\n  return () => {\r\n    stop.current = true;\r\n  };\r\n}\r\n",{"ruleId":"54","replacedBy":"55"},{"ruleId":"56","replacedBy":"57"},{"ruleId":"58","severity":1,"message":"59","line":14,"column":21,"nodeType":"60","messageId":"61","endLine":14,"endColumn":33},{"ruleId":"58","severity":1,"message":"62","line":16,"column":10,"nodeType":"60","messageId":"61","endLine":16,"endColumn":16},{"ruleId":"58","severity":1,"message":"63","line":17,"column":16,"nodeType":"60","messageId":"61","endLine":17,"endColumn":23},{"ruleId":"58","severity":1,"message":"64","line":19,"column":10,"nodeType":"60","messageId":"61","endLine":19,"endColumn":18},{"ruleId":"65","severity":1,"message":"66","line":92,"column":6,"nodeType":"67","endLine":92,"endColumn":8,"suggestions":"68"},{"ruleId":"58","severity":1,"message":"69","line":3,"column":9,"nodeType":"60","messageId":"61","endLine":3,"endColumn":15},{"ruleId":"58","severity":1,"message":"70","line":5,"column":7,"nodeType":"60","messageId":"61","endLine":5,"endColumn":13},{"ruleId":"58","severity":1,"message":"71","line":11,"column":7,"nodeType":"60","messageId":"61","endLine":11,"endColumn":13},{"ruleId":"58","severity":1,"message":"72","line":20,"column":10,"nodeType":"60","messageId":"61","endLine":20,"endColumn":21},{"ruleId":"58","severity":1,"message":"73","line":20,"column":23,"nodeType":"60","messageId":"61","endLine":20,"endColumn":37},{"ruleId":"58","severity":1,"message":"74","line":4,"column":20,"nodeType":"60","messageId":"61","endLine":4,"endColumn":28},{"ruleId":"65","severity":1,"message":"75","line":124,"column":6,"nodeType":"67","endLine":124,"endColumn":15,"suggestions":"76"},{"ruleId":"65","severity":1,"message":"77","line":58,"column":6,"nodeType":"67","endLine":58,"endColumn":11,"suggestions":"78"},"no-native-reassign",["79"],"no-negated-in-lhs",["80"],"@typescript-eslint/no-unused-vars","'setPageTitle' is assigned a value but never used.","Identifier","unusedVar","'volume' is assigned a value but never used.","'setLoop' is assigned a value but never used.","'autoPlay' is assigned a value but never used.","react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'EventEmitter' and 'duration'. Either include them or remove the dependency array.","ArrayExpression",["81"],"'TabBar' is defined but never used.","'Route1' is assigned a value but never used.","'Route2' is assigned a value but never used.","'selectedTab' is assigned a value but never used.","'setSelectedTab' is assigned a value but never used.","'useWatch' is defined but never used.","React Hook useEffect has missing dependencies: 'barWidth' and 'touch.initiated'. Either include them or remove the dependency array.",["82"],"React Hook useEffect has missing dependencies: 'callback' and 'immediate'. Either include them or remove the dependency array. If 'callback' changes too often, find the parent component that defines it and wrap that definition in useCallback.",["83"],"no-global-assign","no-unsafe-negation",{"desc":"84","fix":"85"},{"desc":"86","fix":"87"},{"desc":"88","fix":"89"},"Update the dependencies array to be: [EventEmitter, duration]",{"range":"90","text":"91"},"Update the dependencies array to be: [barWidth, percent, touch.initiated]",{"range":"92","text":"93"},"Update the dependencies array to be: [callback, dep, immediate]",{"range":"94","text":"95"},[3081,3083],"[EventEmitter, duration]",[3985,3994],"[barWidth, percent, touch.initiated]",[1487,1492],"[callback, dep, immediate]"]